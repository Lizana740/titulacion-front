"use strict";(self.webpackChunkdicrea=self.webpackChunkdicrea||[]).push([[177],{3177:($,g,s)=>{s.r(g),s.d(g,{SensorModule:()=>P});var m=s(6895),c=s(3060),a=s(4006),_=s(9421),b=s(5226),p=s.n(b),e=s(4650),C=s(3435);let f=(()=>{class o{constructor(t){this.genericServices=t,this.url="/sensor/"}getSensores(){return this.genericServices.getGeneric(this.url,"lista")}agregarSensores(t){return this.genericServices.postGeneric(this.url,"",t)}eliminarSensor(t){return this.genericServices.deleteGeneric(this.url,t,"")}obtenerSensorPorId(t){return this.genericServices.getGeneric(this.url,t)}actualizarSensor(t,i){return this.genericServices.postGeneric(this.url,t,i)}configurarSensor(t,i){return this.genericServices.postGeneric(this.url+"config/",t,i)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(C.M))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var A=s(8841),q=s(3238),S=s(3608),U=s(805),u=s(47),d=s(9549),I=s(4385),Z=s(4144),x=s(1493);function N(o,r){1&o&&(e.TgZ(0,"th",34),e._uU(1,"Acciones"),e._UZ(2,"p-sortIcon"),e.qZA())}function L(o,r){if(1&o&&(e.TgZ(0,"tr"),e._UZ(1,"th",26),e.TgZ(2,"th",27),e._uU(3,"Nombre Estaci\xf3n"),e._UZ(4,"p-sortIcon",28),e.qZA(),e.TgZ(5,"th",29),e._uU(6,"Ubicaci\xf3n"),e._UZ(7,"p-sortIcon",30),e.qZA(),e.TgZ(8,"th",31),e._uU(9,"Conectados "),e._UZ(10,"p-sortIcon",32),e.qZA(),e.YNc(11,N,3,0,"th",33),e.qZA()),2&o){const t=e.oxw();e.xp6(11),e.Q6J("ngIf","ADMINISTRADOR"==t.rol)}}function J(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"div",10)(2,"div",11)(3,"button",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.add(n.id_estacion))}),e._UZ(4,"i",38),e.qZA()()()()}}function D(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"td")(2,"button",35),e._UZ(3,"i"),e.qZA()(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.YNc(10,J,5,0,"td",36),e.qZA()),2&o){const t=r.$implicit,i=r.expanded,n=e.oxw();e.xp6(2),e.Q6J("pRowToggler",t),e.xp6(1),e.Tol(i?"pi pi-chevron-down":"pi pi-chevron-right"),e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.Oqu(t.ubicacion),e.xp6(2),e.Oqu(t.sensores.length),e.xp6(1),e.Q6J("ngIf","ADMINISTRADOR"==n.rol)}}function y(o,r){1&o&&(e.TgZ(0,"tr")(1,"th",43),e._uU(2,"Modelo "),e._UZ(3,"p-sortIcon",44),e.qZA(),e.TgZ(4,"th",45),e._uU(5," Tipo"),e._UZ(6,"p-sortIcon",46),e.qZA(),e.TgZ(7,"th",47),e._uU(8,"Descripci\xf3n"),e._UZ(9,"p-sortIcon",48),e.qZA(),e.TgZ(10,"th",49),e._uU(11,"Escala "),e._UZ(12,"p-sortIcon",50),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Acciones"),e.qZA()())}function F(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",52),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.eliminarSensor(n.id_sensor))}),e._UZ(2,"i",53),e.qZA()()}}function k(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.editar(n.id_sensor))}),e._UZ(2,"i",55),e.qZA()()}}function E(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",56),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.configurar(n.id_sensor))}),e._UZ(2,"i",57),e.qZA()()}}function M(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td",10),e.YNc(10,F,3,0,"div",51),e.YNc(11,k,3,0,"div",51),e.YNc(12,E,3,0,"div",51),e.qZA()()),2&o){const t=r.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.modelo),e.xp6(2),e.Oqu(t.tipo),e.xp6(2),e.Oqu(t.descripcion),e.xp6(2),e.Oqu(t.escala),e.xp6(2),e.Q6J("ngIf","ADMINISTRADOR"==i.rol),e.xp6(1),e.Q6J("ngIf","ADMINISTRADOR"==i.rol),e.xp6(1),e.Q6J("ngIf","MANTENEDOR"==i.rol)}}function G(o,r){1&o&&(e.TgZ(0,"tr")(1,"td",58),e._uU(2,"No hay sensores actualmente conectados"),e.qZA()())}function w(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"td",39)(2,"div",40)(3,"p-table",41),e.YNc(4,y,15,0,"ng-template",4),e.YNc(5,M,13,7,"ng-template",5),e.YNc(6,G,3,0,"ng-template",42),e.qZA()()()()),2&o){const t=r.$implicit;e.xp6(3),e.Q6J("value",t.sensores)}}function Y(o,r){if(1&o&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function B(o,r){if(1&o&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.modelo),e.xp6(1),e.hij(" ",t.modelo," ")}}function Q(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.display=!n.display)}),e._UZ(1,"i",60),e._uU(2," Cancelar"),e.qZA(),e.TgZ(3,"button",61),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.agregarSensor())}),e._UZ(4,"i",62),e._uU(5," Agregar"),e.qZA()}}function O(o,r){if(1&o&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.p),e.xp6(1),e.AsE(" ",t.p," - ",t.tipo," ")}}function j(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.displayConfig=!n.displayConfig)}),e._UZ(1,"i",60),e._uU(2," Cancelar"),e.qZA(),e.TgZ(3,"button",61),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.configurarSensor())}),e._UZ(4,"i",62),e._uU(5," Guardar"),e.qZA()}}const h=function(){return{width:"60vw",height:"38vw"}},v=function(){return{"960px":"75vw"}},R=[{path:"listar",component:(()=>{class o{constructor(t,i,n,l){this.sensoresService=t,this._formBuilder=i,this.router=n,this.autentificacionServices=l,this.lista=[],this.display=!1,this.tipos=_.Ob,this.displayConfig=!1,this.rol=localStorage.getItem("rol"),this.puertos=[{p:"D1",tipo:"DIGITAL"},{p:"D2",tipo:"DIGITAL"},{p:"D3",tipo:"DIGITAL"},{p:"D4",tipo:"DIGITAL"},{p:"D5",tipo:"DIGITAL"},{p:"D6",tipo:"DIGITAL"},{p:"D7",tipo:"DIGITAL"},{p:"D8",tipo:"DIGITAL"},{p:"D9",tipo:"DIGITAL"},{p:"A0",tipo:"ANALOGICO"}],this.formulario=this._formBuilder.group({descripcion:["",a.kI.required],tipo:["",a.kI.required],escala:["",a.kI.required],modelo:["",a.kI.required]}),this.formularioCongig=this._formBuilder.group({puerto:["",a.kI.required],map:["",a.kI.required],voltaje:["",a.kI.required]})}ngOnInit(){this.getSensores()}getSensores(){this.sensoresService.getSensores().subscribe(t=>{let n=this.autentificacionServices.infoUser().trabajador.id_trabajador;if("MANTENEDOR"==this.rol)for(var l of t.data)for(var T of l.trabajadores)T.id_trabajador==n&&T.Trabaja.id_rol==_.e8&&this.lista.push(l);else this.lista=t.data})}add(t){this.display=!0,this.id_estacion=t}agregarSensor(){this.sensoresService.agregarSensores({descripcion:this.formulario.value.descripcion,tipo:this.formulario.value.tipo,modelo:this.formulario.value.modelo,escala:this.formulario.value.escala,configuracion:null,id_estacion:this.id_estacion}).subscribe(i=>{this.getSensores(),p().fire({icon:"success",title:"Se creo el a\xf1adio el sensor con  \xe9xito!!",showConfirmButton:!1,timer:1500})}),this.display=!1}editar(t){this.router.navigate(["/app/sensor/editar/"+t])}eliminarSensor(t){p().fire({title:"\xbfEstas seguro de eliminar?",text:"Los cambios seran permanentes",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, eliminar"}).then(i=>{this.sensoresService.eliminarSensor(t).subscribe(n=>{this.getSensores()},n=>{p().fire({icon:"error",title:"Oops...",text:"No se ha podido eliminar el sensor!"})})})}changeTipoSensor(t){this.modelos=_.E0.filter(i=>i.tipo==this.formulario.value.tipo)}configurar(t){this.displayConfig=!0,this.id_sensor=t}configurarSensor(){this.formularioCongig.valid&&this.sensoresService.configurarSensor(this.id_sensor,this.formularioCongig.value).subscribe(t=>{this.getSensores(),this.displayConfig=!1,p().fire({icon:"success",title:"Sensor configurado con \xe9xito!!",showConfirmButton:!1,timer:1500})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f),e.Y36(a.qu),e.Y36(c.F0),e.Y36(A.Q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-lista"]],decls:86,vars:26,consts:[[1,"m-3","mt-3"],[1,"card"],[1,"card-header",2,"color","grey"],["dataKey","nombre",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","Agregar Sensor",1,"m-3","mt-3",3,"visible","breakpoints","draggable","resizable","modal","visibleChange"],[1,"mb-4",3,"formGroup"],[1,"container"],[1,"row"],[1,"col"],[1,"col-sm-10"],["appearance","outline",2,"width","100%"],["placeholder","Tipo","formControlName","tipo",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Modelo","formControlName","modelo"],["matInput","","placeholder","Escala de medici\xf3n ","formControlName","escala","required",""],[1,"col-sm-12"],["matInput","","placeholder","Breve descripci\xf3n del sensor","formControlName","descripcion","required",""],["pTemplate","footer"],["header","Configurar Sensor",1,"m-3","mt-3",3,"visible","breakpoints","draggable","resizable","modal","visibleChange"],["placeholder","Puerto","formControlName","puerto"],["matInput","","placeholder","ej: [1-100], [0-1000] ","formControlName","map","required",""],["placeholder","Modelo","formControlName","voltaje"],[3,"value"],[2,"width","5rem"],["pSortableColumn","nombre"],["field","nombre"],["pSortableColumn","ubicacion"],["field","ubicacion"],["pSortableColumn","id_estacion"],["field","category"],["pSortableColumn","",4,"ngIf"],["pSortableColumn",""],["pTooltip","Expandir","tooltipPosition","top",1,"btn",3,"pRowToggler"],[4,"ngIf"],["pTooltip","Agregar","tooltipPosition","top",1,"btn","btn-success",3,"click"],[1,"pi","pi-plus-circle"],["colspan","5"],[1,"p-3"],["dataKey","id_sensor",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","modelo"],["field","customer"],["pSortableColumn","tipo"],["field","date"],["pSortableColumn","descripcion"],["field","amount"],["pSortableColumn","escala"],["field","status"],["class","col",4,"ngIf"],["pTooltip","Eliminar","tooltipPosition","top",1,"btn","btn-danger",3,"click"],[1,"pi","pi-trash"],[1,"btn","btn-warning","text-white",3,"click"],["pTooltip","Editar","tooltipPosition","top",1,"pi","pi-pencil"],[1,"btn","btn-primary","text-white",3,"click"],["pTooltip","Configurar","tooltipPosition","top",1,"pi","pi-cog"],["colspan","6"],[1,"btn","btn-danger",3,"click"],[1,"pi","pi-times"],[1,"btn","btn-primary",3,"click"],[1,"pi","pi-check"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),e._uU(4," Lista de Sensores"),e.qZA()(),e.TgZ(5,"p-table",3),e.YNc(6,L,12,1,"ng-template",4),e.YNc(7,D,11,7,"ng-template",5),e.YNc(8,w,7,1,"ng-template",6),e.qZA()()(),e.TgZ(9,"p-dialog",7),e.NdJ("visibleChange",function(l){return i.display=l}),e.TgZ(10,"form",8),e._UZ(11,"br"),e.TgZ(12,"div",9)(13,"div",10)(14,"div",11)(15,"h2"),e._uU(16,"Tipo"),e.qZA(),e.TgZ(17,"div",12)(18,"mat-form-field",13)(19,"mat-label"),e._uU(20,"Ingrese tipo de sensor"),e.qZA(),e.TgZ(21,"mat-select",14),e.NdJ("selectionChange",function(){return i.changeTipoSensor(i)}),e.YNc(22,Y,2,2,"mat-option",15),e.qZA()()()(),e.TgZ(23,"div",11)(24,"h2"),e._uU(25,"Modelo"),e.qZA(),e.TgZ(26,"div",12)(27,"mat-form-field",13)(28,"mat-label"),e._uU(29,"Ingrese el modelo"),e.qZA(),e.TgZ(30,"mat-select",16),e.YNc(31,B,2,2,"mat-option",15),e.qZA()()()(),e.TgZ(32,"div",11)(33,"h2"),e._uU(34,"Escala"),e.qZA(),e.TgZ(35,"div",12)(36,"mat-form-field",13)(37,"mat-label"),e._uU(38,"Ingrese la escala de medici\xf3n"),e.qZA(),e._UZ(39,"input",17),e.qZA()()()(),e.TgZ(40,"div",10)(41,"h2"),e._uU(42,"Descripci\xf3n"),e.qZA(),e.TgZ(43,"div",18)(44,"mat-form-field",13)(45,"mat-label"),e._uU(46,"Ingrese una descripci\xf3n"),e.qZA(),e._UZ(47,"textarea",19),e.qZA()()()()(),e.YNc(48,Q,6,0,"ng-template",20),e.qZA(),e.TgZ(49,"p-dialog",21),e.NdJ("visibleChange",function(l){return i.displayConfig=l}),e.TgZ(50,"form",8),e._UZ(51,"br"),e.TgZ(52,"div",9)(53,"div",10)(54,"div",11)(55,"h2"),e._uU(56,"Puerto "),e.qZA(),e.TgZ(57,"div",12)(58,"mat-form-field",13)(59,"mat-label"),e._uU(60,"Sleccione un puerto"),e.qZA(),e.TgZ(61,"mat-select",22),e.YNc(62,O,2,3,"mat-option",15),e.qZA()()()()(),e.TgZ(63,"div",10)(64,"div",11)(65,"h2"),e._uU(66,"Rangos "),e.qZA(),e.TgZ(67,"div",12)(68,"mat-form-field",13)(69,"mat-label"),e._uU(70,"Ingrese rango de mapeo"),e.qZA(),e._UZ(71,"input",23),e.qZA()()()(),e.TgZ(72,"div",10)(73,"div",11)(74,"h2"),e._uU(75,"Tensi\xf3n "),e.qZA(),e.TgZ(76,"div",12)(77,"mat-form-field",13)(78,"mat-label"),e._uU(79,"Voltaje de operai\xf3n"),e.qZA(),e.TgZ(80,"mat-select",24)(81,"mat-option",25),e._uU(82," 3.3 V"),e.qZA(),e.TgZ(83,"mat-option",25),e._uU(84," 5 V"),e.qZA()()()()()()()(),e.YNc(85,j,6,0,"ng-template",20),e.qZA()),2&t&&(e.xp6(5),e.Q6J("value",i.lista),e.xp6(4),e.Akn(e.DdM(22,h)),e.Q6J("visible",i.display)("breakpoints",e.DdM(23,v))("draggable",!1)("resizable",!1)("modal",!0),e.xp6(1),e.Q6J("formGroup",i.formulario),e.xp6(12),e.Q6J("ngForOf",i.tipos),e.xp6(9),e.Q6J("ngForOf",i.modelos),e.xp6(18),e.Akn(e.DdM(24,h)),e.Q6J("visible",i.displayConfig)("breakpoints",e.DdM(25,v))("draggable",!1)("resizable",!1)("modal",!0),e.xp6(1),e.Q6J("formGroup",i.formularioCongig),e.xp6(12),e.Q6J("ngForOf",i.puertos),e.xp6(19),e.Q6J("value",3.3),e.xp6(2),e.Q6J("value",5))},dependencies:[m.sg,m.O5,q.ey,S.u,U.jx,u.iA,u.lQ,u.jB,u.fz,d.KE,d.hX,I.gD,Z.Nt,x.V,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u]}),o})(),data:{breadcrumb:{label:"Lista de Sensores"}}},{path:"editar/:id_sensor",component:(()=>{class o{constructor(t,i,n,l){this.sensorServices=t,this._formBuilder=i,this.activatedRoute=n,this.router=l,this.formulario=this._formBuilder.group({modelo:["",a.kI.required],tipo:["",a.kI.required],escala:["",a.kI.required],descripcion:["",a.kI.required]})}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.id=t.get("id_sensor"),this.sensorServices.obtenerSensorPorId(this.id).subscribe(i=>{var n=i.data;this.formulario=this._formBuilder.group({modelo:[n.modelo,a.kI.required],tipo:[n.tipo,a.kI.required],escala:[n.escala,a.kI.required],descripcion:[n.descripcion,a.kI.required]})})})}cancelar(){this.router.navigate(["/app/sensor/listar"])}add(){p().fire({title:"\xbfEstas seguro de guardar los cambios?",text:"Podras volver a editarlos en esta misma secci\xf3n",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Actualizar"}).then(t=>{t.isConfirmed&&this.sensorServices.actualizarSensor(this.id,this.formulario.value).subscribe(i=>{this.router.navigate(["/app/sensor/listar"])})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f),e.Y36(a.qu),e.Y36(c.gz),e.Y36(c.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-editar"]],decls:46,vars:1,consts:[[1,"m-3","mt-3"],[1,"card"],[1,"mb-4",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","ej: DT-11","formControlName","modelo","required",""],["matInput","","placeholder","ej: Sensor de Temperatura","formControlName","tipo","required",""],["matInput","","placeholder","ej: \xb0C, ppm, LUX","formControlName","escala","required",""],["matInput","","placeholder","ej: ubicaci\xf3n, destinado para ...","formControlName","descripcion","required",""],[1,"col-1"],["type","submit",1,"btn","btn-success"],[1,"col-2"],[1,"btn","btn-danger",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.add()}),e._UZ(3,"br"),e.TgZ(4,"div",0)(5,"div",3)(6,"div",4)(7,"h3"),e._uU(8,"Modelo"),e.qZA(),e.TgZ(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),e._uU(12,"Modelo de sensor"),e.qZA(),e._UZ(13,"input",6),e.qZA()()(),e.TgZ(14,"div",4)(15,"h3"),e._uU(16,"Tipo"),e.qZA(),e.TgZ(17,"div",4)(18,"mat-form-field",5)(19,"mat-label"),e._uU(20,"Tipo"),e.qZA(),e._UZ(21,"input",7),e.qZA()()()(),e.TgZ(22,"div",3)(23,"div",4)(24,"h3"),e._uU(25,"Escala"),e.qZA(),e.TgZ(26,"div",4)(27,"mat-form-field",5)(28,"mat-label"),e._uU(29,"Escala de medici\xf3n"),e.qZA(),e._UZ(30,"input",8),e.qZA()()(),e.TgZ(31,"div",4)(32,"h3"),e._uU(33,"Descripci\xf3n"),e.qZA(),e.TgZ(34,"div",4)(35,"mat-form-field",5)(36,"mat-label"),e._uU(37,"Breve descripci\xf3n"),e.qZA(),e._UZ(38,"input",9),e.qZA()()()(),e.TgZ(39,"div",3)(40,"div",10)(41,"button",11),e._uU(42,"Guardar"),e.qZA()(),e.TgZ(43,"div",12)(44,"button",13),e.NdJ("click",function(){return i.cancelar()}),e._uU(45,"Cancelar"),e.qZA()()()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario))},dependencies:[d.KE,d.hX,Z.Nt,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u]}),o})(),data:{breadcrumb:{label:"Editar Sensor"}}}];let z=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.Bz.forChild(R),c.Bz]}),o})();var K=s(5782);let P=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.ez,z,K.m]}),o})()}}]);